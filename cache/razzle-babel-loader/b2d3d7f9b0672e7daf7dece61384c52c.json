{"ast":null,"code":"\"use strict\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar _a, _b, _c, _d, _e, _f, _g;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BillResolver = void 0;\n\nconst common_1 = require(\"@nestjs/common\");\n\nconst graphql_1 = require(\"@nestjs/graphql\");\n\nconst graphql_relay_1 = require(\"graphql-relay\");\n\nconst models_1 = require(\"@/models\");\n\nconst authentication_1 = require(\"@/modules/authentication\");\n\nconst pagination_1 = require(\"@/utils/plugins/pagination\");\n\nconst bill_dto_1 = require(\"./bill.dto\");\n\nconst bill_service_1 = require(\"./bill.service\");\n\nlet BillResolver = class BillResolver {\n  constructor(billService) {\n    _defineProperty(this, \"billService\", void 0);\n\n    this.billService = billService;\n  }\n\n  async getBillsPerMonth(user, args) {\n    const {\n      limit,\n      offset\n    } = args.getPaginationParameters();\n    const bills = await this.billService.find(user.id);\n    return (0, graphql_relay_1.connectionFromArraySlice)(bills, args, {});\n  }\n\n  async getBalancePerMonth(user, args) {\n    return this.billService.balance(user.id, args);\n  }\n\n  async saveBill(user, input) {\n    return this.billService.create(input, user.id);\n  }\n\n};\n\n__decorate([(0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard), (0, pagination_1.Pagination)(() => models_1.Bill), __param(0, (0, authentication_1.CurrentUser)()), __param(1, (0, graphql_1.Args)()), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_a = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _a : Object, typeof (_b = typeof pagination_1.ConnectionArgs !== \"undefined\" && pagination_1.ConnectionArgs) === \"function\" ? _b : Object]), __metadata(\"design:returntype\", Promise)], BillResolver.prototype, \"getBillsPerMonth\", null);\n\n__decorate([(0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard), (0, graphql_1.Query)(() => graphql_1.Int), __param(0, (0, authentication_1.CurrentUser)()), __param(1, (0, graphql_1.Args)()), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_c = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _c : Object, typeof (_d = typeof bill_dto_1.BillGetArgs !== \"undefined\" && bill_dto_1.BillGetArgs) === \"function\" ? _d : Object]), __metadata(\"design:returntype\", Promise)], BillResolver.prototype, \"getBalancePerMonth\", null);\n\n__decorate([(0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard), (0, graphql_1.Mutation)(() => models_1.Bill), __param(0, (0, authentication_1.CurrentUser)()), __param(1, (0, graphql_1.Args)(\"input\")), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_e = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _e : Object, typeof (_f = typeof bill_dto_1.BillInsertInput !== \"undefined\" && bill_dto_1.BillInsertInput) === \"function\" ? _f : Object]), __metadata(\"design:returntype\", Promise)], BillResolver.prototype, \"saveBill\", null);\n\nBillResolver = __decorate([(0, graphql_1.Resolver)(() => models_1.Bill), __metadata(\"design:paramtypes\", [typeof (_g = typeof bill_service_1.BillService !== \"undefined\" && bill_service_1.BillService) === \"function\" ? _g : Object])], BillResolver);\nexports.BillResolver = BillResolver;","map":{"version":3,"sources":["/Users/carlos/Documents/Projetos/Javascript/bills_api/src/modules/bill/bill.resolver.ts"],"names":["_a","_b","_c","_d","_e","_f","_g","Object","defineProperty","exports","value","BillResolver","common_1","require","graphql_1","graphql_relay_1","models_1","authentication_1","pagination_1","bill_dto_1","bill_service_1","constructor","billService","getBillsPerMonth","user","args","limit","offset","getPaginationParameters","bills","find","id","connectionFromArraySlice","getBalancePerMonth","balance","saveBill","input","create","__decorate","UseGuards","GqlAuthenticationGuard","Pagination","Bill","__param","CurrentUser","Args","__metadata","Function","User","ConnectionArgs","Promise","prototype","Query","Int","BillGetArgs","Mutation","BillInsertInput","Resolver","BillService"],"mappings":"AAAA;;;;AACA,IAAIA,EAAJ,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BC,EAA5B;;AACAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,YAAR,GAAuB,KAAK,CAA5B;;AACA,MAAMC,QAAQ,GAAGC,OAAO,CAAC,gBAAD,CAAxB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,iBAAD,CAAzB;;AACA,MAAME,eAAe,GAAGF,OAAO,CAAC,eAAD,CAA/B;;AACA,MAAMG,QAAQ,GAAGH,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMI,gBAAgB,GAAGJ,OAAO,CAAC,0BAAD,CAAhC;;AACA,MAAMK,YAAY,GAAGL,OAAO,CAAC,4BAAD,CAA5B;;AACA,MAAMM,UAAU,GAAGN,OAAO,CAAC,YAAD,CAA1B;;AACA,MAAMO,cAAc,GAAGP,OAAO,CAAC,gBAAD,CAA9B;;AACA,IAAIF,YAAY,GAAG,MAAMA,YAAN,CAAmB;AAElCU,EAAAA,WAAW,CAACC,WAAD,EAAc;AAAA;;AACrB,SAAKA,WAAL,GAAmBA,WAAnB;AACH;;AACqB,QAAhBC,gBAAgB,CAACC,IAAD,EAAOC,IAAP,EAAa;AAC/B,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA;AAAT,QAAoBF,IAAI,CAACG,uBAAL,EAA1B;AACA,UAAMC,KAAK,GAAG,MAAM,KAAKP,WAAL,CAAiBQ,IAAjB,CAAsBN,IAAI,CAACO,EAA3B,CAApB;AACA,WAAO,CAAC,GAAGhB,eAAe,CAACiB,wBAApB,EAA8CH,KAA9C,EAAqDJ,IAArD,EAA2D,EAA3D,CAAP;AACH;;AACuB,QAAlBQ,kBAAkB,CAACT,IAAD,EAAOC,IAAP,EAAa;AACjC,WAAO,KAAKH,WAAL,CAAiBY,OAAjB,CAAyBV,IAAI,CAACO,EAA9B,EAAkCN,IAAlC,CAAP;AACH;;AACa,QAARU,QAAQ,CAACX,IAAD,EAAOY,KAAP,EAAc;AACxB,WAAO,KAAKd,WAAL,CAAiBe,MAAjB,CAAwBD,KAAxB,EAA+BZ,IAAI,CAACO,EAApC,CAAP;AACH;;AAfiC,CAAtC;;AAiBAO,UAAU,CAAC,CACP,CAAC,GAAG1B,QAAQ,CAAC2B,SAAb,EAAwBtB,gBAAgB,CAACuB,sBAAzC,CADO,EAEP,CAAC,GAAGtB,YAAY,CAACuB,UAAjB,EAA6B,MAAMzB,QAAQ,CAAC0B,IAA5C,CAFO,EAGPC,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG1B,gBAAgB,CAAC2B,WAArB,GAAJ,CAHA,EAIPD,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG7B,SAAS,CAAC+B,IAAd,GAAJ,CAJA,EAKPC,UAAU,CAAC,aAAD,EAAgBC,QAAhB,CALH,EAMPD,UAAU,CAAC,mBAAD,EAAsB,CAAC,QAAQ9C,EAAE,GAAG,OAAOgB,QAAQ,CAACgC,IAAhB,KAAyB,WAAzB,IAAwChC,QAAQ,CAACgC,IAA9D,MAAwE,UAAxE,GAAqFhD,EAArF,GAA0FO,MAA3F,EAAmG,QAAQN,EAAE,GAAG,OAAOiB,YAAY,CAAC+B,cAApB,KAAuC,WAAvC,IAAsD/B,YAAY,CAAC+B,cAAhF,MAAoG,UAApG,GAAiHhD,EAAjH,GAAsHM,MAAzN,CAAtB,CANH,EAOPuC,UAAU,CAAC,mBAAD,EAAsBI,OAAtB,CAPH,CAAD,EAQPvC,YAAY,CAACwC,SARN,EAQiB,kBARjB,EAQqC,IARrC,CAAV;;AASAb,UAAU,CAAC,CACP,CAAC,GAAG1B,QAAQ,CAAC2B,SAAb,EAAwBtB,gBAAgB,CAACuB,sBAAzC,CADO,EAEP,CAAC,GAAG1B,SAAS,CAACsC,KAAd,EAAqB,MAAMtC,SAAS,CAACuC,GAArC,CAFO,EAGPV,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG1B,gBAAgB,CAAC2B,WAArB,GAAJ,CAHA,EAIPD,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG7B,SAAS,CAAC+B,IAAd,GAAJ,CAJA,EAKPC,UAAU,CAAC,aAAD,EAAgBC,QAAhB,CALH,EAMPD,UAAU,CAAC,mBAAD,EAAsB,CAAC,QAAQ5C,EAAE,GAAG,OAAOc,QAAQ,CAACgC,IAAhB,KAAyB,WAAzB,IAAwChC,QAAQ,CAACgC,IAA9D,MAAwE,UAAxE,GAAqF9C,EAArF,GAA0FK,MAA3F,EAAmG,QAAQJ,EAAE,GAAG,OAAOgB,UAAU,CAACmC,WAAlB,KAAkC,WAAlC,IAAiDnC,UAAU,CAACmC,WAAzE,MAA0F,UAA1F,GAAuGnD,EAAvG,GAA4GI,MAA/M,CAAtB,CANH,EAOPuC,UAAU,CAAC,mBAAD,EAAsBI,OAAtB,CAPH,CAAD,EAQPvC,YAAY,CAACwC,SARN,EAQiB,oBARjB,EAQuC,IARvC,CAAV;;AASAb,UAAU,CAAC,CACP,CAAC,GAAG1B,QAAQ,CAAC2B,SAAb,EAAwBtB,gBAAgB,CAACuB,sBAAzC,CADO,EAEP,CAAC,GAAG1B,SAAS,CAACyC,QAAd,EAAwB,MAAMvC,QAAQ,CAAC0B,IAAvC,CAFO,EAGPC,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG1B,gBAAgB,CAAC2B,WAArB,GAAJ,CAHA,EAIPD,OAAO,CAAC,CAAD,EAAI,CAAC,GAAG7B,SAAS,CAAC+B,IAAd,EAAoB,OAApB,CAAJ,CAJA,EAKPC,UAAU,CAAC,aAAD,EAAgBC,QAAhB,CALH,EAMPD,UAAU,CAAC,mBAAD,EAAsB,CAAC,QAAQ1C,EAAE,GAAG,OAAOY,QAAQ,CAACgC,IAAhB,KAAyB,WAAzB,IAAwChC,QAAQ,CAACgC,IAA9D,MAAwE,UAAxE,GAAqF5C,EAArF,GAA0FG,MAA3F,EAAmG,QAAQF,EAAE,GAAG,OAAOc,UAAU,CAACqC,eAAlB,KAAsC,WAAtC,IAAqDrC,UAAU,CAACqC,eAA7E,MAAkG,UAAlG,GAA+GnD,EAA/G,GAAoHE,MAAvN,CAAtB,CANH,EAOPuC,UAAU,CAAC,mBAAD,EAAsBI,OAAtB,CAPH,CAAD,EAQPvC,YAAY,CAACwC,SARN,EAQiB,UARjB,EAQ6B,IAR7B,CAAV;;AASAxC,YAAY,GAAG2B,UAAU,CAAC,CACtB,CAAC,GAAGxB,SAAS,CAAC2C,QAAd,EAAwB,MAAMzC,QAAQ,CAAC0B,IAAvC,CADsB,EAEtBI,UAAU,CAAC,mBAAD,EAAsB,CAAC,QAAQxC,EAAE,GAAG,OAAOc,cAAc,CAACsC,WAAtB,KAAsC,WAAtC,IAAqDtC,cAAc,CAACsC,WAAjF,MAAkG,UAAlG,GAA+GpD,EAA/G,GAAoHC,MAArH,CAAtB,CAFY,CAAD,EAGtBI,YAHsB,CAAzB;AAIAF,OAAO,CAACE,YAAR,GAAuBA,YAAvB","sourcesContent":["\"use strict\";\nvar _a, _b, _c, _d, _e, _f, _g;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BillResolver = void 0;\nconst common_1 = require(\"@nestjs/common\");\nconst graphql_1 = require(\"@nestjs/graphql\");\nconst graphql_relay_1 = require(\"graphql-relay\");\nconst models_1 = require(\"@/models\");\nconst authentication_1 = require(\"@/modules/authentication\");\nconst pagination_1 = require(\"@/utils/plugins/pagination\");\nconst bill_dto_1 = require(\"./bill.dto\");\nconst bill_service_1 = require(\"./bill.service\");\nlet BillResolver = class BillResolver {\n    billService;\n    constructor(billService) {\n        this.billService = billService;\n    }\n    async getBillsPerMonth(user, args) {\n        const { limit, offset } = args.getPaginationParameters();\n        const bills = await this.billService.find(user.id);\n        return (0, graphql_relay_1.connectionFromArraySlice)(bills, args, {});\n    }\n    async getBalancePerMonth(user, args) {\n        return this.billService.balance(user.id, args);\n    }\n    async saveBill(user, input) {\n        return this.billService.create(input, user.id);\n    }\n};\n__decorate([\n    (0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard),\n    (0, pagination_1.Pagination)(() => models_1.Bill),\n    __param(0, (0, authentication_1.CurrentUser)()),\n    __param(1, (0, graphql_1.Args)()),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _a : Object, typeof (_b = typeof pagination_1.ConnectionArgs !== \"undefined\" && pagination_1.ConnectionArgs) === \"function\" ? _b : Object]),\n    __metadata(\"design:returntype\", Promise)\n], BillResolver.prototype, \"getBillsPerMonth\", null);\n__decorate([\n    (0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard),\n    (0, graphql_1.Query)(() => graphql_1.Int),\n    __param(0, (0, authentication_1.CurrentUser)()),\n    __param(1, (0, graphql_1.Args)()),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [typeof (_c = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _c : Object, typeof (_d = typeof bill_dto_1.BillGetArgs !== \"undefined\" && bill_dto_1.BillGetArgs) === \"function\" ? _d : Object]),\n    __metadata(\"design:returntype\", Promise)\n], BillResolver.prototype, \"getBalancePerMonth\", null);\n__decorate([\n    (0, common_1.UseGuards)(authentication_1.GqlAuthenticationGuard),\n    (0, graphql_1.Mutation)(() => models_1.Bill),\n    __param(0, (0, authentication_1.CurrentUser)()),\n    __param(1, (0, graphql_1.Args)(\"input\")),\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [typeof (_e = typeof models_1.User !== \"undefined\" && models_1.User) === \"function\" ? _e : Object, typeof (_f = typeof bill_dto_1.BillInsertInput !== \"undefined\" && bill_dto_1.BillInsertInput) === \"function\" ? _f : Object]),\n    __metadata(\"design:returntype\", Promise)\n], BillResolver.prototype, \"saveBill\", null);\nBillResolver = __decorate([\n    (0, graphql_1.Resolver)(() => models_1.Bill),\n    __metadata(\"design:paramtypes\", [typeof (_g = typeof bill_service_1.BillService !== \"undefined\" && bill_service_1.BillService) === \"function\" ? _g : Object])\n], BillResolver);\nexports.BillResolver = BillResolver;\n"]},"metadata":{},"sourceType":"script"}
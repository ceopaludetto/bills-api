{"version":3,"file":"server.a049da96ac2b29d60488.hot-update.js","sources":["webpack://bills_api/./src/modules/bill/bill.service.ts","webpack://bills_api/webpack/runtime/getFullHash"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BillService = void 0;\nconst nestjs_1 = require(\"@mikro-orm/nestjs\");\nconst common_1 = require(\"@nestjs/common\");\nconst models_1 = require(\"@/models\");\nconst date_1 = require(\"@/utils/date\");\nlet BillService = class BillService {\n    billRepository;\n    constructor(billRepository) {\n        this.billRepository = billRepository;\n    }\n    async find(userID, { date = new Date() }) {\n        return this.billRepository.find({\n            user: userID,\n            createdAt: { $gte: (0, date_1.day)(date).startOf(\"month\").toDate(), $lte: (0, date_1.day)(date).endOf(\"month\").toDate() },\n        });\n    }\n    async balance(userID, { date = new Date() }) {\n        const queryBuilder = this.billRepository.createQueryBuilder();\n        const res = queryBuilder\n            .select('sum(\"bill\".\"value\")')\n            .where({\n            user: userID,\n            createdAt: { $gte: (0, date_1.day)(date).startOf(\"month\").toDate(), $lte: (0, date_1.day)(date).endOf(\"month\").toDate() },\n        })\n            .getResult();\n        console.log(res);\n        return res;\n    }\n    async create(data, userID) {\n        const bill = this.billRepository.create({ ...data, user: userID });\n        await this.billRepository.persistAndFlush(bill);\n        return bill;\n    }\n};\nBillService = __decorate([\n    (0, common_1.Injectable)(),\n    __param(0, (0, nestjs_1.InjectRepository)(models_1.Bill)),\n    __metadata(\"design:paramtypes\", [Object])\n], BillService);\nexports.BillService = BillService;\n","__webpack_require__.h = () => (\"99088e0b7c1ccfe397fc\")"],"mappings":";;;;;;;;;;;AAAA;AACA;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAFA;AAIA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AAAA;AAFA;AAKA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AA5BA;AA6BA;AAKA;;A;;;;;;;;;ACzCA;;;;A","sourceRoot":""}